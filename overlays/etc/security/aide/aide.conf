# LockClaw AIDE configuration
# File integrity monitoring — detects unauthorized changes to critical files
#
# Usage:
#   aide --check            ← compare current state to baseline
#   aide --init             ← regenerate baseline (after approved changes)
#   aide --update           ← check + generate new baseline in one pass
#
# The baseline database is created at Docker build time. Any modification
# to the watched files/dirs after build triggers an alert.

# Database locations
database_in=file:/var/lib/aide/aide.db
database_out=file:/var/lib/aide/aide.db.new
database_new=file:/var/lib/aide/aide.db.new

# What to check — define rule groups
# p: permissions  u: user  g: group  s: size  m: mtime
# S: check for growing size  sha256: SHA-256 hash
NORMAL = p+u+g+s+m+sha256
PERMS  = p+u+g
LOG    = p+u+g+s+S

# ── Critical system binaries ────────────────────────────────
/usr/sbin  NORMAL
/usr/bin   NORMAL
/sbin      NORMAL
/bin       NORMAL

# ── Security configuration files ────────────────────────────
/etc/passwd       NORMAL
/etc/shadow       NORMAL
/etc/group        NORMAL
/etc/gshadow      NORMAL
/etc/sudoers      NORMAL
/etc/sudoers.d    NORMAL
/etc/ssh          NORMAL
/etc/nftables.conf NORMAL
/etc/fail2ban     NORMAL
/etc/audit        NORMAL
/etc/security     NORMAL
/etc/login.defs   NORMAL
/etc/pam.d        NORMAL

# ── LockClaw tooling ────────────────────────────────────────
/opt/lockclaw     NORMAL

# ── Container entrypoint ────────────────────────────────────
/usr/local/bin/docker-entrypoint.sh NORMAL

# ── Exclude dynamic/runtime paths ───────────────────────────
!/var/log
!/var/run
!/var/cache
!/tmp
!/proc
!/sys
!/dev
!/run
!/var/lib/aide
!/var/lib/fail2ban
!/var/lib/dpkg
!/var/lib/apt
!/home
!/root
